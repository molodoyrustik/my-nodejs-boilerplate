{"version":3,"file":null,"sources":["../src/config/index.js","../src/middlewares/accessLogger.js","../src/middlewares/reqParser.js","../src/middlewares/catchError.js","../src/middlewares/reqLog.js","../src/middlewares/extendReqRes.js","../src/middlewares/index.js","../src/models/Domain/Domain.js","../src/models/User/User.js","../src/models/Token/Token.js","../src/models/Domain/DomainModel.js","../src/models/index.js","../src/resourses/Auth/Auth.js","../src/resourses/DomainController/DomainController.js","../src/resourses/index.js","../src/api/auth/auth.js","../src/api/domain/domain.js","../src/api/api.js","../src/App.js","../src/index.js"],"sourcesContent":["global.__DEV__ = true;\n// __STAGE__\nglobal.__PROD__ = false;\n\nexport default {\n  name: 'Your super app',\n  port: 3001,\n  db: {\n    url: 'mongodb://localhost/test',\n  },\n  jwt: {\n    secret: 'YOUR_SECRET',\n  },\n  nodemailer: {\n    service: 'mail',\n    host: 'smtp.mail.ru',\n    auth: {\n      user: 'molodoyrustik@mail.ru',\n      pass: 'molodoy'\n    }\n  },\n};\n","import leftPad from 'left-pad';\n\nfunction levelFn(data) {\n  if (data.err || data.status >= 500 || data.duration > 10000) { // server internal error or error\n    return 'error';\n  } else if (data.status >= 400 || data.duration > 3000) { // client error\n    return 'warn';\n  }\n  return 'info';\n}\n\nfunction logStart(data) {\n  return `${leftPad(data.method, 4)} ${data.url} started reqId=${data.reqId}`;\n}\n\nfunction logFinish(data) {\n  const time = (data.duration || 0).toFixed(3);\n  const length = data.length || 0;\n  return `${leftPad(data.method, 4)} ${data.url} ${leftPad(data.status, 3)} ${leftPad(time, 7)}ms ${leftPad(length, 5)}b reqId=${data.reqId}`;\n}\n\nexport default (params) => ([\n  (req, res, next) => {\n    const data = {}\n    if (!req.log) throw 'has no req.log!'\n    const log = req.log.child({\n      component: 'req',\n    });\n\n    data.reqId = req.reqId\n    data.method = req.method\n    if (req.ws) data.method = 'WS'\n    data.host = req.headers.host\n    data.url = (req.baseUrl || '') + (req.url || '-')\n    data.referer = req.header('referer') || req.header('referrer')\n    data.ip = req.ip || req.connection.remoteAddress ||\n        (req.socket && req.socket.remoteAddress) ||\n        (req.socket.socket && req.socket.socket.remoteAddress) ||\n        '127.0.0.1'\n\n\n    if (__DEV__) {\n      log.debug(data, logStart(data));\n      if (req.body) {\n        log.trace(JSON.stringify(req.body));\n      }\n    }\n\n    const hrtime = process.hrtime();\n    function logging() {\n      data.status = res.statusCode\n      data.length = res.getHeader('Content-Length')\n\n      const diff = process.hrtime(hrtime);\n      data.duration = diff[0] * 1e3 + diff[1] * 1e-6\n\n      log[levelFn(data)](data, logFinish(data));\n    }\n    res.on('finish', logging);\n    res.on('close', logging);\n    next();\n  }\n])\n","import cookieParser from 'cookie-parser'\nimport bodyParser from 'body-parser'\nimport cors from 'cors'\n\nexport default (ctx) => ([\n  bodyParser.json(),\n  bodyParser.urlencoded({ extended: true }),\n  cookieParser(),\n  cors(),\n])\n","export default (ctx) => (\n  (err, req, res, next) => {\n    if(req && req.log && req.log.error){\n      req.log.error({\n        err,\n        query: req.query,\n        body: req.body,\n        headers: req.headers\n      }, (err || {}).stack)\n    } else {\n      console.log(err)\n    }\n    res.status(err.status || 500)\n    return res.json([]);\n    if (res.err) return res.err(err)\n    return res.json(err)\n  }\n)\n","import uuid from 'uuid'\n\nexport default (params) => ([\n  (req, res, next) => {\n    if (__PROD__) {\n      req.reqId = uuid.v4()\n    } else {\n      global.reqId = 1 + (global.reqId || 0)\n      req.reqId = global.reqId\n    }\n    if (params.log) {\n      req.log = params.log.child({\n        reqId: req.reqId,\n      });\n    }\n    next()\n  },\n])\n","import _ from 'lodash'\nexport default (ctx) => ([\n  (req, res, next) => {\n    if (ctx.requests) {\n      _.forEach(ctx.requests, (val, key) => {\n        req[key] = val.bind(req)\n      })\n      // if (req.allParams) {\n      //   req.params = req.allParams.bind(req)()\n      // }\n    }\n    if (ctx.responses) {\n      _.forEach(ctx.responses, (val, key) => {\n        res[key] = val.bind(res)\n      })\n    }\n    next()\n  }\n])\n","// fs\nimport accessLogger from './accessLogger'\nimport reqParser from './reqParser'\nimport catchError from './catchError'\nimport reqLog from './reqLog'\nimport extendReqRes from './extendReqRes'\n\nexport default function (ctx) {\n  return {\n    accessLogger: accessLogger(...arguments),\n    reqParser: reqParser(...arguments),\n    catchError: catchError(...arguments),\n    reqLog: reqLog(...arguments),\n    extendReqRes: extendReqRes(...arguments),\n  }\n}\n","import _ from 'lodash'\r\nimport mongoose from 'mongoose'\r\n\r\nconst LogSchema = new mongoose.Schema({\r\n  id: {\r\n    type: String,\r\n    trim: true,\r\n  }\r\n})\r\n\r\nconst DomainSchema = new mongoose.Schema({\r\n  id: {\r\n    type: String,\r\n    trim: true,\r\n  },\r\n  url: {\r\n    type: String,\r\n    trim: true,\r\n  },\r\n  logs: [LogSchema],\r\n})\r\n\r\nexport default DomainSchema\r\n","import _ from 'lodash'\nimport jwt from 'jsonwebtoken'\nimport bcrypt from 'bcryptjs'\nimport Promise from 'bluebird'\nconst bcryptGenSalt = Promise.promisify(bcrypt.genSalt)\nconst bcryptHash = Promise.promisify(bcrypt.hash)\nconst bcryptCompare = Promise.promisify(bcrypt.compare)\nimport mongoose from 'mongoose'\n\nimport DomainSchema from '../Domain/Domain';\n\nexport default (ctx) => {\n  if (!ctx.log) throw '!log'\n\n  const schema = new mongoose.Schema({\n    email: {\n      type: String,\n      required: true,\n      trim: true,\n    },\n    id: {\n      type: String,\n      trim: true,\n    },\n    password: {\n      type: String,\n    },\n    domains: [DomainSchema]\n  }, {\n    collection: 'user',\n    timestamps: true,\n  })\n\n  schema.statics.isValidEmail = function (email) {\n    const re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(email)\n  }\n  schema.statics.generatePassword = function (length = 10) {\n    return Math.random().toString(36).substr(2, length)\n  }\n  schema.methods.toJSON = function () {\n    return _.omit(this.toObject(), ['password'])\n  }\n  schema.methods.getIdentity = function (params) {\n    const object = _.pick(this.toObject(), ['_id', 'email', 'id'])\n    if (!params) return object\n    return Object.assign(object, params)\n  }\n  schema.methods.generateAuthToken = function (params) {\n    return jwt.sign(this.getIdentity(params), ctx.config.jwt.secret)\n  }\n  schema.methods.verifyPassword = async function (password) {\n    return await bcryptCompare(password, this.password)\n  }\n\n  const SALT_WORK_FACTOR = 10\n  schema.pre('save', function (next) {\n    if (!this.isModified('password')) return next();\n    return bcryptGenSalt(SALT_WORK_FACTOR)\n    .then(salt => {\n      bcryptHash(this.password, salt)\n      .then(hash => {\n        this.password = hash\n        next();\n      })\n    })\n    .catch(next)\n  });\n\n  return mongoose.model('User', schema);\n}\n","import _ from 'lodash'\r\nimport jwt from 'jsonwebtoken'\r\nimport bcrypt from 'bcryptjs'\r\nimport Promise from 'bluebird'\r\nconst bcryptGenSalt = Promise.promisify(bcrypt.genSalt)\r\nconst bcryptHash = Promise.promisify(bcrypt.hash)\r\nconst bcryptCompare = Promise.promisify(bcrypt.compare)\r\nimport mongoose from 'mongoose'\r\n\r\nexport default (ctx) => {\r\n  if (!ctx.log) throw '!log'\r\n\r\n  const schema = new mongoose.Schema({\r\n    id: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    userID: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    forgotEmailToken: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n  }, {\r\n    collection: 'token',\r\n    timestamps: true,\r\n  })\r\n\r\n  return mongoose.model('Token', schema);\r\n}\r\n","import mongoose from 'mongoose'\r\nimport DomainSchema from './Domain';\r\n\r\nexport default (ctx) => {\r\n  if (!ctx.log) throw '!log'\r\n\r\n  return  mongoose.model('Domain', DomainSchema);\r\n}\r\n","import User from './User/User.js';\nimport Token from './Token/Token.js';\nimport DomainSchema from './Domain/Domain';\nimport Domain from './Domain/DomainModel';\n\nexport default function () {\n  return {\n    Domain: Domain(...arguments),\n    User: User(...arguments),\n    Token: Token(...arguments),\n    scheme: {\n      DomainSchema,\n    }\n  }\n}\n","import jwt from 'express-jwt'\nimport uniqid from 'uniqid';\nimport crypto from 'crypto';\nimport mongoose from 'mongoose';\n\nexport function canonize(str) {\n  return str.toLowerCase().trim()\n}\n\nexport default (ctx) => {\n  const User = ctx.models.User;\n  const Token = ctx.models.Token;\n  const Domain = ctx.models.Domain;\n  const transporter = ctx.transporter;\n\n  const resourse = {}\n\n  resourse.validate = async function (req, res) {\n    if(req.user) {\n      const user = await User.findById(req.user._id)\n      if (!user) return res.status(404).json([{validate: false, message: 'Пользователь не найден в базе'}]);\n      return [{\n        validate: true,\n        __pack: 1,\n        jwt: req.user,\n        user: user,\n      }]\n    }\n    return res.status(404).json([{validate: false, message: 'Пользователь не найден в базе'}]);\n  }\n\n  resourse.getUserFields = function (req) {\n    return req.body;\n  }\n\n  resourse.validationUserFields = function(userFields, res) {\n    let valid = {\n      isValid: false,\n      message: []\n    }\n\n    if(!userFields.captcha) {\n      valid.isValid = true;\n      valid.message = [{signup: false, message: 'Параметр captcha не передан или введен неверно'}]\n    }\n\n    if(!userFields.email || !userFields.password) {\n      valid.isValid = true;\n      valid.message = [{signup: false, message: 'Параметрs email или password не передан'}]\n    }\n\n    return valid;\n  }\n\n  resourse.getUserCriteria = function (req, res) {\n    const params = req.body\n    if (params.email) {\n      return {\n        email: params.email,\n      }\n    }\n    return res.status(400).json([{signup: false, message: 'Параметр email не передан'}]);\n  }\n\n  resourse.signup = async function (req, res) {\n    try {\n      const userFields = resourse.getUserFields(req, res);\n      const valid = resourse.validationUserFields(userFields, res);\n      if (valid.isValid) {\n        return res.status(400).json(valid.message);\n      }\n      const criteria = resourse.getUserCriteria(req, res);\n\n      const existUser = await User.findOne(criteria)\n      if (existUser) return res.status(400).json([{signup: false, message: 'Такой email зарегистрирован'}])\n\n      const user = new User({ ...userFields, id: uniqid()})\n\n\n      await user.save()\n      const userToken = new Token({ userID: user.id , id: uniqid(), forgotEmailToken: '' })\n      await userToken.save();\n\n      const result = [{\n        signup: true,\n        user,\n        token: user.generateAuthToken(),\n      }]\n\n      return res.json(result)\n\n    } catch(err) {\n      console.log(err);\n      return res.status(500).json(err)\n    }\n  }\n\n  resourse.login = async function (req, res) {\n    const params = resourse.getUserFields(req, res);\n    if (!params.password) return res.status(400).json([{login: false, message: 'Параметр password не передан'}]);\n\n    const criteria = resourse.getUserCriteria(req);\n    const user = await User.findOne(criteria);\n\n    if (!user) return res.status(404).json([{login: false, message: 'Такой пользователь не найден'}]);\n    await user.save();\n\n    if (!await user.verifyPassword(params.password)) {\n      return res.status(400).json([{login: false, message: 'Переданный пароль не подходит'}]);\n    }\n\n    return res.json([{\n      __pack: 1,\n      login: true,\n      user,\n      token: user.generateAuthToken(),\n    }])\n  }\n\n  resourse.forgot = async function (req, res) {\n    const params = resourse.getUserFields(req, res);\n\n    if (!params.email) return res.status(400).json([{ forgot: false, message: 'Параметр email не передан' }]);\n    if (!params.captcha) return res.status(400).json([{ forgot: false, message: 'Параметр captcha не передан' }]);\n\n    const criteria = resourse.getUserCriteria(req);\n    const user = await User.findOne(criteria);\n\n    if (!user) return res.status(404).json([{login: false, message: 'Пользователь с таким email не найден в базе'}]);\n\n    const token = await crypto.randomBytes(32);\n    const userToken = await Token.findOne({userID: user.id})\n    userToken.forgotEmailToken = token.toString('hex');\n    await userToken.save();\n\n\n    let mailText = `Перейдите по ссылке чтобы изменить пароль http://localhost:3000/auth/forgot/${userToken.forgotEmailToken}`;\n\n    var mailOptions = {\n      from: 'molodoyrustik@mail.ru',\n      to: user.email,\n      subject: 'Восстановления пароля сайта Ashile.io',\n      text: mailText\n    };\n    await transporter.sendMail(mailOptions);\n\n    const result = [{\n      __pack: 1,\n      forgot: true\n    }];\n    return res.json(result);\n  }\n\n  resourse.checkForgotToken = async function (req, res) {\n    const { forgotEmailToken } = req.params;\n    if (!forgotEmailToken) {\n      return res.status(400).json([{checkForgotToken: false, message: 'Токен не был передан'}]);\n    }\n\n    const criteria = { forgotEmailToken };\n    const userToken = await Token.findOne(criteria);\n\n    if (!userToken) return res.status(404).json([{checkForgotToken: false, message: 'Пользователь с таким токеном не найден'}]);\n\n    return res.json([{\n        __pack: 1,\n        checkForgotToken: true\n    }]);\n  }\n\n  resourse.reset = async function (req, res) {\n    const params = resourse.getUserFields(req, res);\n    const { password, checkPassword, captcha, forgotEmailToken, } = params;\n\n    if (!password) return res.status(400).json([{reset: false, message: 'Параметр password не передан'}]);\n    if (!checkPassword) return res.status(400).json([{reset: false, message: 'Параметр checkPassword не передан'}]);\n    if (password !== checkPassword) return res.status(400).json([{reset: false, message: 'Пароли не совпадают'}]);\n    if (!captcha) return res.status(400).json([{reset: false, message: 'Параметр captcha не передан'}]);\n    if (!forgotEmailToken) return res.status(400).json([{reset: false, message: 'Параметр forgotEmailToken не передан'}]);\n\n    const criteria = { forgotEmailToken };\n    const userToken = await Token.findOne(criteria);\n    if (!userToken) return res.status(404).json([{reset: false, message: 'Не корректный токен'}]);\n    const { userID } = userToken;\n    userToken.forgotEmailToken = '';\n    await userToken.save();\n\n    const user = await User.findOne({id: userID});\n    if (!user) return res.status(404).json([{reset: false, message: 'Такой пользователь не найден'}]);\n    user.password = password;\n    await user.save();\n\n    return res.json([{\n      __pack: 1,\n      reset: true\n    }])\n  }\n\n  resourse.getToken = function (req) {\n    if (req.headers.authorization && req.headers.authorization.split( ' ' )[ 0 ] === 'Bearer') {\n      return req.headers.authorization.split( ' ' )[ 1 ]\n    } else if (req.headers['x-access-token']) {\n      return req.headers['x-access-token'];\n    } else if ( req.query && req.query.token ) {\n      return req.query.token\n    } else if ( req.cookies && req.cookies.token  ) {\n      return req.cookies.token\n    }\n    if (__DEV__ && ctx.config && ctx.config.jwt && ctx.config.jwt.devToken) return ctx.config.jwt.devToken\n    return null;\n  }\n\n  resourse.parseToken = function (req, res, next) {\n    const token = resourse.getToken(req)\n    req.token = token\n    next()\n  }\n\n  resourse.parseUser = function (req, res, next) {\n    const options = {\n      secret: ctx.config && ctx.config.jwt.secret || 'SECRET',\n      getToken: req => req.token,\n    }\n    jwt(options)(req, res, (err) => {\n      if (err) req._errJwt = err\n      next()\n    })\n  }\n\n  resourse.isAuth = function (req, res, next) {\n    if (req._errJwt) return next(req._errJwt)\n    if (!req.user || !req.user._id) return res.status(401).send('!req.user')\n    next()\n  }\n\n  return resourse\n}\n","import jwt from 'express-jwt'\r\nimport uniqid from 'uniqid';\r\n\r\n\r\nexport default (ctx) => {\r\n  const User = ctx.models.User;\r\n  const Domain = ctx.models.Domain;\r\n\r\n  let resourse = {};\r\n\r\n  resourse.domains = async function(req, res) {\r\n    const userID = req.user.id;\r\n    const user = await User.findOne({id: userID});\r\n\r\n    return res.json(user.domains);\r\n  }\r\n\r\n  resourse.create = async function(req, res) {\r\n    const params = req.body\r\n    if (!params.url) {\r\n      return res.status(400).json([{signup: false, message: 'Домен не передан'}]);\r\n    }\r\n    const { url } = params;\r\n\r\n    const userID = req.user.id;\r\n    const user = await User.findOne({id: userID});\r\n    const domain = new Domain({ url, id: uniqid(), })\r\n    user.domains.push(domain);\r\n    await user.save();\r\n\r\n    return res.json([{ flag: true, message: 'Домен успешно добавлен'}]);\r\n  }\r\n\r\n  resourse.edit = async function(req, res) {\r\n    const params = req.body\r\n    if (!params.url) {\r\n      return res.status(400).json([{signup: false, message: 'Домен не передан'}]);\r\n    }\r\n    if (!params.id) {\r\n      return res.status(400).json([{signup: false, message: 'Id домена не передан'}]);\r\n    }\r\n    const { url, id } = params;\r\n\r\n    const userID = req.user.id;\r\n    const user = await User.findOne({id: userID});\r\n    user.domains.find((domain) => { return domain.id === id }).url = url;\r\n    await user.save();\r\n\r\n    return res.json([{ flag: true, message: 'Домен успешно изменен'}]);\r\n  }\r\n\r\n  resourse.delete = async function(req, res) {\r\n\r\n    if (!req.params.id) {\r\n      return res.status(400).json([{signup: false, message: 'Id домена не передан'}]);\r\n    }\r\n    const { id } = req.params;\r\n\r\n    const userID = req.user.id;\r\n    const user = await User.findOne({id: userID});\r\n    user.domains = user.domains.filter((domain)=>{ return domain.id != id });\r\n    await user.save();\r\n\r\n    return res.json([{ flag: true, message: 'Домен успешно удален'}]);\r\n  }\r\n\r\n  resourse.logs = async function(req, res) {\r\n    if (!req.params.domainId) {\r\n      return res.status(400).json([{signup: false, message: 'Id домена не передан'}]);\r\n    }\r\n    const { domainId } = req.params;\r\n    const userID = req.user.id;\r\n\r\n    const user = await User.findOne({id: userID});\r\n    if (!user) {\r\n      return res.status(400).json([{signup: false, message: 'Пользователь не найден'}]);\r\n    }\r\n    const domain = user.domains.find((domain) => (domain.id === domainId));\r\n    const { logs } = domain;\r\n\r\n    return res.json([{ flag: true, logs }]);\r\n  }\r\n\r\n  return resourse\r\n}\r\n","import Auth from './Auth/Auth';\nimport DomainController from './DomainController/DomainController';\n\nexport default function () {\n  return {\n    Auth: Auth(...arguments),\n    DomainController: DomainController(...arguments),\n  }\n}\n","import _ from 'lodash';\nimport mongoose from 'mongoose';\nimport { AsyncRouter } from 'express-async-router';\nimport Auth from '../../resourses/Auth/Auth';\n\n\nexport default (ctx) => {\n  if (!_.has(ctx, 'resourses.Auth.signup')) throw '!resourses.Auth.signup'\n  if (!_.has(ctx, 'resourses.Auth.login')) throw '!resourses.Auth.login'\n  if (!_.has(ctx, 'resourses.Auth.validate')) throw '!resourses.Auth.validate'\n  if (!_.has(ctx, 'resourses.Auth.forgot')) throw '!resourses.Auth.forgot'\n  if (!_.has(ctx, 'resourses.Auth.checkForgotToken')) throw '!resourses.Auth.checkForgotToken'\n  if (!_.has(ctx, 'resourses.Auth.reset')) throw '!resourses.Auth.reset'\n\tconst api = AsyncRouter();\n\n  api.all('/validate', ctx.resourses.Auth.validate);\n  api.post('/signup', ctx.resourses.Auth.signup);\n  api.post('/login', ctx.resourses.Auth.login);\n  api.post('/forgot', ctx.resourses.Auth.forgot);\n  api.get('/forgot/:forgotEmailToken', ctx.resourses.Auth.checkForgotToken);\n  api.post('/reset', ctx.resourses.Auth.reset);\n\n\n\treturn api;\n}\n","import _ from 'lodash';\r\nimport mongoose from 'mongoose';\r\nimport { AsyncRouter } from 'express-async-router';\r\nimport DomainController from '../../resourses/DomainController/DomainController';\r\n\r\n\r\nexport default (ctx) => {\r\n  if (!_.has(ctx, 'resourses.DomainController.domains')) throw '!resourses.DomainController.domains'\r\n  if (!_.has(ctx, 'resourses.DomainController.create')) throw '!resourses.DomainController.create'\r\n  if (!_.has(ctx, 'resourses.DomainController.delete')) throw '!resourses.DomainController.delete'\r\n  if (!_.has(ctx, 'resourses.DomainController.edit')) throw '!resourses.DomainController.edit'\r\n  if (!_.has(ctx, 'resourses.DomainController.edit')) throw '!resourses.DomainController.logs'\r\n\r\n\tconst api = AsyncRouter();\r\n\r\n  api.get('/', ctx.resourses.DomainController.domains);\r\n  api.post('/create', ctx.resourses.DomainController.create);\r\n  api.delete('/delete/:id', ctx.resourses.DomainController.delete);\r\n  api.put('/edit', ctx.resourses.DomainController.edit);\r\n  api.get('/:domainId/logs', ctx.resourses.DomainController.logs);\r\n\r\n\treturn api;\r\n}\r\n","import mongoose from 'mongoose';\nimport { AsyncRouter } from 'express-async-router';\nimport expressJwt from 'express-jwt';\nimport getAuth from './auth/auth';\nimport getDomain from './domain/domain';\n\nexport default (ctx) => {\n\tconst api = AsyncRouter();\n\n  api.all('/', () => ({ok: true, version: '1.0.1'}))\n\n  api.use('/auth', getAuth(ctx));\n\tapi.use('/domains', expressJwt({secret: ctx.config.jwt.secret}), getDomain(ctx));\n\n\tapi.use('/domains',(function(err, req, res, next) {\n\t\treturn res.status(401).json([{flag: false, message: 'Неправильный токен'}]);\n\t}))\n\n\treturn api;\n}\n","import bunyan from 'bunyan';\nimport express from 'express';\nimport mongoose from 'mongoose';\nimport nodemailer from 'nodemailer';\nimport smtpTransport from 'nodemailer-smtp-transport';\nimport getMiddlewares from './middlewares/index';\nimport getModels from './models/index';\nimport getResourses from './resourses/index';\nimport getApi from './api/api';\n\n\nexport default class App {\n  constructor(params = {}) {\n    Object.assign(this, params);\n    if (!this.log) this.log = this.getLogger();\n    this.init();\n  }\n\n  getLogger(params) {\n    return bunyan.createLogger(Object.assign({\n      name: 'app',\n      src: __DEV__,\n      level: 'trace',\n    }, params))\n  }\n\n  getMiddlewares() {\n    return getMiddlewares(this);\n  }\n  getModels() {\n    return getModels(this);\n  }\n  getDatabase() {\n    return {\n      run: () => {\n        new Promise((resolve) => {\n          mongoose.connect(this.config.db.url);\n          resolve();\n        });\n      }\n    }\n  }\n  getResourses() {\n    return getResourses(this);\n  }\n\n  init() {\n    this.log.trace('App init');\n    const transporter = nodemailer.createTransport(smtpTransport(this.config.nodemailer));\n    this.transporter = transporter;\n\n    this.app = express();\n    this.db = this.getDatabase();\n    this.middlewares = this.getMiddlewares();\n    this.log.trace('middlewares', Object.keys(this.middlewares));\n    this.models = this.getModels();\n    this.log.trace('models', Object.keys(this.models));\n    this.resourses = this.getResourses();\n    this.log.trace('resourses', Object.keys(this.resourses));\n\n    this.useMiddlewares();\n    this.useRoutes();\n    this.useDefaultRoute();\n  }\n\n  useMiddlewares() {\n    this.app.use(this.middlewares.catchError);\n    this.app.use(this.middlewares.reqLog);\n    this.app.use(this.middlewares.accessLogger);\n    this.app.use(this.middlewares.reqParser);\n    this.app.use(this.resourses.Auth.parseToken);\n    this.app.use(this.resourses.Auth.parseUser);\n  }\n  useRoutes() {\n    const api = getApi(this);\n    this.app.use('/api/v1', api);\n  }\n  useDefaultRoute() {\n    this.app.use((req, res, next) => {\n      const err = ('Route not found');\n      next(err);\n    });\n  }\n\n  async run() {\n    this.log.trace('App run');\n    try {\n      await this.db.run();\n    } catch (err) {\n      this.log.fatal(err);\n    }\n    return new Promise((resolve) => {\n      this.app.listen(this.config.port, () => {\n        this.log.info(`App \"${this.config.name}\" running on port ${this.config.port}!`);\n        resolve(this);\n      });\n    });\n  }\n}\n","import config from './config/index';\nimport App from './App';\n\nconst app = new App({ config });\napp.run();\n"],"names":["global","__DEV__","__PROD__","levelFn","data","err","status","duration","logStart","leftPad","method","url","reqId","logFinish","time","toFixed","length","params","req","res","next","log","child","ws","host","headers","baseUrl","referer","header","ip","connection","remoteAddress","socket","debug","body","trace","hrtime","process","logging","statusCode","getHeader","diff","on","ctx","bodyParser","json","urlencoded","extended","cookieParser","cors","error","query","stack","uuid","v4","requests","forEach","val","key","bind","responses","accessLogger","arguments","reqParser","catchError","reqLog","extendReqRes","LogSchema","mongoose","Schema","String","DomainSchema","bcryptGenSalt","Promise","promisify","bcrypt","genSalt","bcryptHash","hash","bcryptCompare","compare","schema","statics","isValidEmail","email","re","test","generatePassword","Math","random","toString","substr","methods","toJSON","_","omit","toObject","getIdentity","object","pick","generateAuthToken","jwt","sign","config","secret","verifyPassword","password","SALT_WORK_FACTOR","pre","isModified","then","salt","catch","model","Domain","User","Token","models","transporter","resourse","validate","user","findById","_id","message","getUserFields","validationUserFields","userFields","valid","captcha","isValid","signup","getUserCriteria","findOne","criteria","existUser","id","uniqid","save","userID","forgotEmailToken","userToken","result","login","forgot","crypto","randomBytes","token","mailText","sendMail","mailOptions","checkForgotToken","reset","checkPassword","getToken","authorization","split","cookies","devToken","parseToken","parseUser","options","_errJwt","isAuth","send","domains","create","push","domain","flag","edit","find","delete","filter","logs","domainId","Auth","DomainController","has","api","AsyncRouter","all","resourses","post","get","put","ok","version","use","getAuth","expressJwt","getDomain","App","getLogger","init","bunyan","createLogger","getMiddlewares","getModels","resolve","connect","db","getResourses","nodemailer","createTransport","smtpTransport","app","express","getDatabase","middlewares","useMiddlewares","useRoutes","useDefaultRoute","getApi","run","fatal","listen","port","info","name"],"mappings":"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"}